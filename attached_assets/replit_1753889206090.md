# RWA Calculator - Bank Al-Maghrib

## Overview

This project is a **Risk-Weighted Assets (RWA) Calculator** application built for Bank Al-Maghrib (Morocco's central bank). It's a Streamlit-based web application that helps financial institutions calculate risk-weighted assets according to Bank Al-Maghrib's regulatory requirements. The application provides data validation, RWA calculations, visualization capabilities, and PDF report generation.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

The application follows a **modular monolithic architecture** with clear separation of concerns:

- **Frontend**: Streamlit web framework providing an interactive dashboard
- **Backend Logic**: Python modules handling business logic (RWA calculations, data validation, PDF generation)
- **Data Processing**: Pandas-based data manipulation and validation
- **Visualization**: Plotly for interactive charts and graphs
- **Reporting**: ReportLab for PDF generation with matplotlib for chart integration

## Key Components

### 1. Main Application (`app.py`)
- **Purpose**: Central Streamlit application orchestrating the user interface
- **Features**: 
  - Professional UI with custom CSS styling
  - Data upload and display capabilities
  - Integration with all backend modules
  - Interactive dashboard layout

### 2. RWA Calculator (`rwa_calculator.py`)
- **Purpose**: Core business logic for calculating Risk-Weighted Assets
- **Architecture**: Rule-based calculation engine with configurable weighting rules
- **Segments Supported**:
  - Sovereign entities (governments, central banks)
  - Public organizations
  - Multilateral Development Banks (BMD)
  - Credit institutions
  - Banking entities
  - Enterprises
  - TPE (Very Small Enterprises)
  - Individuals
  - Real estate

### 3. Data Validator (`data_validator.py`)
- **Purpose**: Ensures data quality and compliance with expected formats
- **Validation Types**:
  - Required column presence
  - Data type validation
  - Business rule validation (valid ratings, currencies, segments)
- **Error Handling**: Categorized feedback (errors, warnings, info)

### 4. PDF Generator (`pdf_generator.py`)
- **Purpose**: Creates professional regulatory reports
- **Technologies**: ReportLab for PDF generation, matplotlib for chart integration
- **Features**: Custom styling, tables, charts, and structured reporting

## Data Flow

1. **Data Input**: Users upload Excel/CSV files through Streamlit interface
2. **Validation**: Data validator checks format, completeness, and business rules
3. **Processing**: RWA calculator applies regulatory rules to calculate risk weights
4. **Visualization**: Plotly generates interactive charts and dashboards
5. **Reporting**: PDF generator creates downloadable regulatory reports

## External Dependencies

### Core Libraries
- **streamlit**: Web application framework
- **pandas**: Data manipulation and analysis
- **numpy**: Numerical computations
- **plotly**: Interactive visualization (express and graph_objects)

### Reporting & Visualization
- **matplotlib**: Chart generation for PDF reports
- **reportlab**: PDF generation library

### Data Processing
- **io**: File handling and BytesIO operations
- **base64**: File encoding for downloads

## Deployment Strategy

The application is designed as a **single-page Streamlit application** suitable for:

- **Local Development**: Direct Python execution with `streamlit run app.py`
- **Cloud Deployment**: Compatible with Streamlit Cloud, Heroku, or Docker containers
- **Enterprise Deployment**: Can be containerized for internal banking infrastructure

### Configuration Considerations
- Wide layout configuration for financial dashboards
- Professional styling with Bank Al-Maghrib branding
- Responsive design for different screen sizes
- Error handling and user-friendly validation feedback

### Security Considerations
- Data validation prevents malformed input
- No persistent data storage (session-based processing)
- Suitable for sensitive financial data with proper infrastructure security

## Technical Architecture Decisions

### Framework Choice: Streamlit
- **Problem**: Need for rapid development of financial dashboard
- **Solution**: Streamlit for its simplicity and built-in web capabilities
- **Rationale**: Allows focus on business logic rather than web development complexity

### Modular Design
- **Problem**: Complex regulatory calculations requiring maintainability
- **Solution**: Separate modules for each concern (calculation, validation, reporting)
- **Benefits**: Easy testing, maintenance, and future regulatory updates

### Rule-Based Calculator
- **Problem**: Complex and changing regulatory requirements
- **Solution**: Configurable rule engine with method-based implementations
- **Benefits**: Easy updates when regulations change, clear audit trail

### Plotly for Visualization
- **Problem**: Need for interactive financial charts
- **Solution**: Plotly for rich, interactive visualizations
- **Rationale**: Better user experience compared to static charts, professional appearance